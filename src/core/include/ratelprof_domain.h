/** THIS FILE HAS BEEN AUTOMATICALLY GENERATED BY THE GILDA TOOL.
 * DO NOT MODIFY UNLESS YOU KNOW WHAT YOU ARE DOING.
 * ANY CHANGES MAY BE OVERWRITTEN BY SUBSEQUENT RUNS OF GILDA. 
 */

#ifndef RATELPROF_DOMAIN_H
#define RATELPROF_DOMAIN_H

#include "ratelprof.h"

#include "hsa_conf.h"
#ifdef HAVE_HSA
#include "domains/hsa_api_helper.h"
extern ratelprof_api_table_t hsa_api_table;
#endif

#include "omp_tgt_rtl_conf.h"
#ifdef HAVE_OMP_TGT_RTL
#include "domains/omp_tgt_rtl_api_helper.h"
extern ratelprof_api_table_t omp_tgt_rtl_api_table;
#endif

#include "omp_routine_conf.h"
#ifdef HAVE_OMP_ROUTINE
#include "domains/omp_routine_api_helper.h"
extern ratelprof_api_table_t omp_routine_api_table;
#endif

#include "hip_conf.h"
#ifdef HAVE_HIP
#include "domains/hip_api_helper.h"
extern ratelprof_api_table_t hip_api_table;
#endif

#include "mpi_conf.h"
#ifdef HAVE_MPI
#include "domains/mpi_api_helper.h"
extern ratelprof_api_table_t mpi_api_table;
#endif


typedef struct {
    ratelprof_api_table_t* api_table_addr;
    size_t nb_function;
    const char* name;
    const char* lib_path_envname;
    const char* filter_type_envname;
    const char* functions_filtered_envname;
    
    // Function helpers
    const char* (*get_funame_by_id) (mpi_api_id_t id);
    ratelprof_api_id_t (*get_funid_by_name) (const char* name);
    void* (*get_funaddr_by_id) (mpi_api_id_t id);
} ratelprof_domain_class_t;

#define DEFINE_DOMAIN(UNAME, LNAME) {                                       \
    .api_table_addr             = &LNAME##_api_table,                       \
    .nb_function                = UNAME##_API_ID_NB_FUNCTION,               \
    .name                       = DOMAIN_STR(UNAME),                        \
    .lib_path_envname           = DOMAIN_STR(UNAME) "_LIB_PATH",            \
    .filter_type_envname        = DOMAIN_STR(UNAME) "_FILTER_TYPE",         \
    .functions_filtered_envname = DOMAIN_STR(UNAME) "_FUNCTIONS_FILTERED",  \
    .get_funame_by_id           = (const char* (*) (mpi_api_id_t id)) get_##LNAME##_funame_by_id,      \
    .get_funid_by_name          = (ratelprof_api_id_t (*) (const char* name)) get_##LNAME##_funid_by_name,    \
    .get_funaddr_by_id          = (void* (*) (mpi_api_id_t id)) get_##LNAME##_funaddr_by_id            \
}

#define EMPTY_DOMAIN {0}

extern ratelprof_domain_class_t domains_data[RATELPROF_NB_DOMAIN];

#endif // RATELPROF_DOMAIN_H